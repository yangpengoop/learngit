// 提交登录表单方法
$('#loginBtn').click(function(){
    LogPwdForm();
});

// 通用手机验证码倒计时方法
var wait = 120;
function time(o) {
    if(wait == 0) {
        o.removeAttr("disabled");
        o.text('重新發送');
        //设置倒计时秒数
        wait = 120;
    } else {
        o.attr("disabled", true);
        o.text("(" + wait + ")")
        wait--;
        setTimeout(function() {
            time(o)
        },
        1000);
    }
}

//切换验证码
function changeverifyError() 
{
    $("#verifyImg").attr("src", '/captcha?id='+ "?" + Math.random());
}
// 提交登录表单方法
function LogPwdForm(){
	
	   var username =$("#username").val();    //用户名
       var password =$("#password").val();    //密码
       var code    =$("#code").val();         //图片验证码
       
	   if(username=='')
	   {
		   layer.msg('用戶名不能為空');
		   return false;
	   }
	   if(password=='')
	   {
		   layer.msg('密碼不能為空');
		   return false;
	   }
	   if(code=='')
	   {
		   layer.msg('圖片驗證碼不能為空');
		   return false;
	   }
	
    $.ajax({
        type: "POST",
        url: "/admin/login/sub_login",
        data: {'username':username,'password':password,'code':code},
        dataType: "json",
        success: function(data) {
            if(data.status == true)
            {
                 layer.msg(data.msg);
				 if(data.status == true)
				 {   
					setTimeout(function(){window.location.href=data.redirect_url;},1500);
				 } 
            }
            else
            {
                layer.msg(data.msg);
                //验证出错重置验证码
                changeverifyError() 
            }
        }
    });
}